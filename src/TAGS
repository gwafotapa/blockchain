
network.rs,793
pub struct Network {Network18,455
impl Network {Network24,593
    pub fn with_capacity(n: usize) -> Self {with_capacity25,608
    pub fn add(&mut self, node: Node) {add33,815
    pub fn random(nodes: usize) -> Self {random38,949
    pub fn run(&mut self) {run91,2919
    pub fn broadcast(&self, message: Message) {broadcast101,3177
    pub fn threads_mut(&mut self) -> &mut Vec<Option<JoinHandle<Node>>> {threads_mut108,3385
fn random_graph(vertices: usize) -> Graph {random_graph113,3498
// impl Drop for Network {Network149,4618
//     fn drop(&mut self) {drop150,4645
impl fmt::Debug for Network {Network168,5278
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt169,5308
mod test {test187,5791
    fn test_random_graph() {test_random_graph191,5833

node.rs,1548
pub struct Node {Node19,565
impl Eq for Node {}Node35,981
impl PartialEq for Node {Node37,1002
    fn eq(&self, other: &Node) -> bool {eq38,1028
impl Hash for Node {Node43,1122
    fn hash<H: Hasher>(&self, state: &mut H) {hash44,1143
impl Node {Node49,1236
    pub fn new(new50,1248
    pub fn run(&mut self) {run82,2170
    pub fn initiate(&mut self) -> Option<Transaction> {initiate116,3497
    pub fn propagate(&self, message: Message) {propagate165,5472
    pub fn process(&mut self, message: Message) {process173,5733
    pub fn id(&self) -> usize {id248,9523
    pub fn public_key(&self) -> &PublicKey {public_key252,9578
    pub fn secret_key(&self) -> &SecretKey {secret_key256,9655
    pub fn sender(&self) -> &Sender<Arc<Vec<u8>>> {sender260,9732
    pub fn listener(&self) -> &Receiver<Arc<Vec<u8>>> {listener264,9812
    pub fn neighbours(&self) -> &Vec<(usize, PublicKey, Sender<Arc<Vec<u8>>>)> {neighbours268,9898
    pub fn utxo_pool(&self) -> &UtxoPool {utxo_pool272,10011
    pub fn transaction_pool(&self) -> &TransactionPool {transaction_pool276,10085
    pub fn wallet(&self) -> &Wallet {wallet280,10180
    pub fn blockchain(&self) -> &Blockchain {blockchain284,10246
pub struct Synchronizer {Synchronizer289,10326
impl Synchronizer {Synchronizer294,10416
    pub fn new(barrier: Arc<Barrier>, state: Arc<Mutex<Vec<bool>>>) -> Self {new295,10436
    pub fn barrier(&self) -> &Arc<Barrier> {barrier299,10553
    pub fn state(&self) -> Arc<Mutex<Vec<bool>>> {state303,10627

wallet.rs,933
pub struct Wallet {Wallet8,172
impl Wallet {Wallet13,244
    pub fn new(public_key: PublicKey, utxos: Vec<Utxo>) -> Self {new14,258
    pub fn add(&mut self, utxo: Utxo) {add19,421
    pub fn remove(&mut self, utxo: &Utxo) {remove26,602
    pub fn remove_utxo_from(&mut self, input: &TransactionInput) {remove_utxo_from33,784
    pub fn process(&mut self, transaction: &Transaction) {process40,1011
    pub fn process_all(&mut self, transactions: &[Transaction]) {process_all56,1553
    pub fn undo(&mut self, transaction: &Transaction, blockchain: &Blockchain) {undo62,1717
    pub fn undo_all(&mut self, transactions: &[Transaction], blockchain: &Blockchain) {undo_all79,2328
    pub fn public_key(&self) -> &PublicKey {public_key86,2597
    pub fn utxos(&self) -> &Vec<Utxo> {utxos90,2674
impl fmt::Display for Wallet {Wallet95,2743
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt96,2774

main.rs,24
fn main() {main14,273

chain.rs,1551
pub struct Blockchain {Blockchain11,242
impl Blockchain {Blockchain17,375
    pub fn new() -> Self {new18,393
    // pub fn push(&mut self, block: Block) -> (Vec<Transaction>, Vec<Transaction>) {push30,693
    pub fn push(&mut self, block: Block) {push36,921
    // pub fn add(&mut self, block: Block) -> BlockHash {add48,1334
    // pub fn remove_orphans_of(&mut self, block_hash: BlockHash) -> Vec<Block> {remove_orphans_of67,2076
    // pub fn transaction_delta(transaction_delta81,2527
    pub fn transaction_delta(&self, old_top: &Block) -> (Vec<Transaction>, Vec<Transaction>) {transaction_delta104,3496
    pub fn contains(&self, block: &Block) -> bool {contains123,4306
    pub fn parent(&self, block: &Block) -> Option<&Block> {parent127,4412
    pub fn common_parent<'a>(common_parent131,4528
    pub fn get_utxo_from(&self, input: &TransactionInput) -> Utxo {get_utxo_from156,5389
    pub fn top(&self) -> &Block {top166,5700
    pub fn height(&self) -> usize {height170,5777
    pub fn len(&self) -> usize {len174,5848
    pub fn chain(&self) -> &HashMap<BlockHash, Block> {chain178,5914
    // pub fn orphans(&self) -> &HashMap<BlockHash, Block> {orphans182,5997
    pub fn top_hash(&self) -> &BlockHash {top_hash186,6093
impl fmt::Display for Blockchain {Blockchain191,6168
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt192,6203
impl Eq for Blockchain {}Blockchain217,7050
impl PartialEq for Blockchain {Blockchain219,7077
    fn eq(&self, other: &Self) -> bool {eq220,7109

common.rs,1181
pub const GENESIS_BLOCK_HASH_PREV_BLOCK: [u8; 32] = [0u8; 32];GENESIS_BLOCK_HASH_PREV_BLOCK9,175
pub const MINE_NEW_BLOCK_PROBA: f64 = 1.0 / 100000.0;MINE_NEW_BLOCK_PROBA10,238
pub const NODES: usize = 4;NODES11,292
pub const SIGNATURE_BYTES: usize = 64;SIGNATURE_BYTES12,320
pub const SPEND_PROBA: f64 = 1.0 / 1000000.0;SPEND_PROBA13,359
pub const TX_INPUT_BYTES: usize = UTXO_ID_BYTES + SIGNATURE_BYTES;TX_INPUT_BYTES14,405
pub const TX_OUTPUT_BYTES: usize = UTXO_DATA_BYTES;TX_OUTPUT_BYTES15,472
pub const TXS_PER_BLOCK: usize = 2;TXS_PER_BLOCK16,524
pub const UTXO_AMOUNT_INIT: u32 = 10;UTXO_AMOUNT_INIT17,560
pub const UTXO_DATA_BYTES: usize = 4 + 33;UTXO_DATA_BYTES18,598
pub const UTXO_HASH_INIT: [u8; 32] = [0u8; 32];UTXO_HASH_INIT19,641
pub const UTXO_ID_BYTES: usize = 32 + 8;UTXO_ID_BYTES20,689
const SHUT_DOWN: &[u8] = b"Shut down";SHUT_DOWN22,731
pub enum Message<'a> {Message25,796
impl<'a, B> From<B> for Message<'a>Message31,902
    fn from(bytes: B) -> Self {from35,966
impl<'a> Message<'a> {Message48,1384
    pub fn serialize(&self) -> Vec<u8> {serialize49,1407
    pub fn deserialize<T>(bytes: T) -> Selfdeserialize57,1669

transaction/pool.rs,1254
pub struct TransactionPool {TransactionPool12,259
impl TransactionPool {TransactionPool16,327
    pub fn new() -> Self {new17,350
    pub fn size(&self) -> usize {size23,447
    pub fn add(&mut self, transaction: Transaction) {add28,559
    pub fn remove(&mut self, transaction: &Transaction) -> Option<Transaction> {remove32,665
    pub fn contains(&self, transaction: &Transaction) -> bool {contains37,838
    pub fn position(&self, transaction: &Transaction) -> Option<usize> {position41,957
    pub fn select(&self) -> Option<Vec<Transaction>> {select45,1103
    pub fn add_all(&mut self, transactions: Vec<Transaction>) {add_all57,1422
    pub fn remove_all(&mut self, transactions: &[Transaction]) {remove_all63,1579
    pub fn transactions(&self) -> &Vec<Transaction> {transactions69,1741
impl fmt::Display for TransactionPool {TransactionPool74,1831
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt75,1871
impl Eq for TransactionPool {}TransactionPool84,2156
impl PartialEq for TransactionPool {TransactionPool86,2188
    fn eq(&self, other: &Self) -> bool {eq87,2225
impl Index<usize> for TransactionPool {TransactionPool94,2508
    fn index(&self, index: usize) -> &Self::Output {index97,2580

transaction/error.rs,460
pub enum TransactionError {TransactionError5,48
impl fmt::Display for TransactionError {TransactionError10,136
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt11,177
impl error::Error for TransactionError {TransactionError19,416
    fn source(&self) -> Option<&(dyn error::Error + 'static)> {source20,457
impl From<secp256k1::Error> for TransactionError {TransactionError28,681
    fn from(err: secp256k1::Error) -> Self {from29,732

transaction/mod.rs,1298
pub struct Transaction {Transaction17,440
impl Transaction {Transaction23,554
    pub fn new(inputs: Vec<TransactionInput>, outputs: Vec<TransactionOutput>) -> Self {new24,573
    pub fn serialize(&self) -> Vec<u8> {serialize40,1038
    pub fn deserialize<B>(bytes: B) -> (Self, usize)deserialize50,1469
    pub fn hash_merkle_root(transactions: &Vec<Self>) -> Hash {hash_merkle_root76,2378
    pub fn bytes(&self) -> usize {bytes82,2620
    pub fn id(&self) -> Hash {id86,2756
    pub fn inputs(&self) -> &Vec<TransactionInput> {inputs90,2810
    pub fn outputs(&self) -> &Vec<TransactionOutput> {outputs94,2891
// impl<B> From<B> for TransactionTransaction99,2977
//     fn from(bytes: B) -> Self {from103,3049
impl Eq for Transaction {}Transaction127,3960
impl PartialEq for Transaction {Transaction129,3988
    fn eq(&self, other: &Self) -> bool {eq130,4021
impl fmt::Display for Transaction {Transaction135,4099
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt136,4135
impl HashTrait for Transaction {Transaction160,4824
    fn hash<H: Hasher>(&self, state: &mut H) {hash161,4857
pub mod error;error166,4942
pub mod input;input167,4957
pub mod merkle_tree;merkle_tree168,4972
pub mod output;output169,4993
pub mod pool;pool170,5009

transaction/output.rs,564
pub struct TransactionOutput(pub UtxoData);TransactionOutput7,151
impl TransactionOutput {TransactionOutput9,196
    pub fn new(amount: u32, public_key: PublicKey) -> Self {new10,221
    pub fn serialize(&self) -> Vec<u8> {serialize14,337
    pub fn deserialize<B>(bytes: B) -> Selfdeserialize18,412
    pub fn amount(&self) -> u32 {amount25,546
    pub fn public_key(&self) -> &PublicKey {public_key29,611
// impl fmt::Display for TransactionOutput {TransactionOutput34,694
//     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt35,739

transaction/input.rs,734
pub struct TransactionInput {TransactionInput7,150
impl TransactionInput {TransactionInput12,224
    pub fn new(utxo_id: UtxoId, sig: Signature) -> Self {new13,248
    pub fn serialize(&self) -> Vec<u8> {serialize17,343
    pub fn deserialize<B>(bytes: B) -> Selfdeserialize24,572
    pub fn utxo_id(&self) -> &UtxoId {utxo_id31,689
    pub fn sig(&self) -> &Signature {sig35,757
    pub fn txid(&self) -> Hash {txid39,820
    pub fn vout(&self) -> usize {vout43,888
impl<B> From<B> for TransactionInputTransactionInput48,959
    fn from(bytes: B) -> Self {from52,1024
// impl fmt::Display for TransactionInput {TransactionInput60,1258
//     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt61,1302

transaction/merkle_tree.rs,163
pub struct MergeHash {}MergeHash6,91
impl Merge for MergeHash {MergeHash8,116
    fn merge(left: &Self::Item, right: &Self::Item) -> Self::Item {merge11,166

block/error.rs,412
pub enum BlockError {BlockError6,97
impl fmt::Display for BlockError {BlockError11,191
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt12,226
impl error::Error for BlockError {BlockError22,525
    fn source(&self) -> Option<&(dyn error::Error + 'static)> {source23,560
impl From<TransactionError> for BlockError {BlockError31,784
    fn from(err: TransactionError) -> Self {from32,829

block/mod.rs,1499
// const GENESIS_BLOCK_HASH_MERKLE_ROOT: &[u8; 32] =GENESIS_BLOCK_HASH_MERKLE_ROOT14,315
pub struct Block {Block18,475
impl Block {Block24,577
    pub fn genesis() -> Self {genesis25,590
    pub fn new(height: usize, hash_prev_block: Hash, transactions: Vec<Transaction>) -> Self {new37,1000
    pub fn get_utxo_from(&self, input: &TransactionInput) -> Option<Utxo> {get_utxo_from51,1473
    // pub fn child(&self, transactions: Vec<Transaction>) -> Self {child65,1988
    //     pub fn hash_merkle_root(&self) -> Hash {hash_merkle_root69,2134
    pub fn hash(&self) -> Hash {hash73,2244
    pub fn serialize(&self) -> Vec<u8> {serialize81,2465
    pub fn deserialize<B>(bytes: B) -> Selfdeserialize99,3214
    pub fn is_genesis(&self) -> bool {is_genesis106,3331
    pub fn transaction_count(&self) -> usize {transaction_count110,3402
    pub fn id(&self) -> Hash {id114,3488
    pub fn height(&self) -> usize {height118,3546
    pub fn hash_prev_block(&self) -> Hash {hash_prev_block122,3609
    pub fn transactions(&self) -> &Vec<Transaction> {transactions126,3698
impl Eq for Block {}Block131,3788
impl PartialEq for Block {Block133,3810
    fn eq(&self, other: &Self) -> bool {eq134,3837
impl<B> From<B> for BlockBlock139,3923
    fn from(bytes: B) -> Self {from143,3977
impl fmt::Display for Block {Block166,4716
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt167,4746
pub mod error;error184,5246
pub mod header;header185,5261

block/header.rs,422
pub struct BlockHeader {BlockHeader4,50
impl BlockHeader {BlockHeader10,155
    pub fn new(hash_prev_block: Hash) -> Self {new11,174
    pub fn serialize(&self) -> Vec<u8> {serialize15,262
    pub fn deserialize<B>(bytes: B) -> Selfdeserialize19,348
    pub fn hash_prev_block(&self) -> Hash {hash_prev_block26,465
impl<B> From<B> for BlockHeaderBlockHeader31,547
    fn from(bytes: B) -> Self {from35,607

lib.rs,251
pub mod block;block1,0
pub mod chain;chain2,15
pub mod common;common3,30
pub mod miner;miner4,46
pub mod network;network5,61
pub mod node;node6,78
pub mod transaction;transaction7,92
pub mod utxo;utxo8,113
pub mod wallet;wallet9,127

miner.rs,362
pub struct Miner {Miner7,124
impl Miner {Miner11,172
    pub fn new() -> Self {new12,185
    pub fn mine(&mut self, top: &Block, transaction_pool: &TransactionPool) -> Option<Block> {mine16,248
    pub fn mine_from(&mut self, top: &Block, transaction_pool: &TransactionPool) {mine_from29,664
    pub fn discard_block(&mut self) {discard_block40,1057

utxo/id.rs,542
pub struct UtxoId {UtxoId6,122
impl UtxoId {UtxoId11,178
    pub fn new(txid: Hash, vout: usize) -> Self {new12,192
    pub fn serialize(&self) -> Vec<u8> {serialize16,277
    pub fn deserialize<B>(bytes: B) -> Selfdeserialize23,490
    pub fn txid(&self) -> Hash {txid30,607
    pub fn vout(&self) -> usize {vout34,665
impl<B> From<B> for UtxoIdUtxoId39,726
    fn from(bytes: B) -> Self {from43,781
// impl fmt::Display for UtxoId {UtxoId51,1014
//     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt52,1048

utxo/data.rs,589
pub struct UtxoData {UtxoData7,121
impl UtxoData {UtxoData12,190
    pub fn new(amount: u32, public_key: PublicKey) -> Self {new13,206
    pub fn serialize(&self) -> Vec<u8> {serialize17,310
    pub fn deserialize<B>(bytes: B) -> Selfdeserialize24,541
    pub fn amount(&self) -> u32 {amount31,658
    pub fn public_key(&self) -> &PublicKey {public_key35,719
impl<B> From<B> for UtxoDataUtxoData40,798
    fn from(bytes: B) -> Self {from44,855
// impl fmt::Display for UtxoData {UtxoData52,1133
//     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt53,1169

utxo/pool.rs,1263
pub struct UtxoPool {UtxoPool13,392
impl UtxoPool {UtxoPool17,454
    pub fn new(keys: Vec<PublicKey>) -> Self {new18,470
    pub fn add(&mut self, utxo: Utxo) {add33,883
    pub fn remove(&mut self, utxo: &Utxo) -> Option<UtxoData> {remove37,976
    pub fn contains(&self, utxo: Utxo) -> bool {contains41,1083
    pub fn owned_by(&self, pk: &PublicKey) -> Vec<Utxo> {owned_by45,1181
    pub fn process(&mut self, transaction: &Transaction) {process53,1433
    pub fn undo(&mut self, transaction: &Transaction, blockchain: &Blockchain) {undo65,1969
    pub fn verify(&self, transaction: &Transaction) -> Result<(), TransactionError> {verify79,2565
    pub fn validate(&self, block: &Block) -> Result<(), BlockError> {validate103,3514
    pub fn process_all(&mut self, transactions: &[Transaction]) {process_all113,3832
    pub fn undo_all(&mut self, transactions: &[Transaction], blockchain: &Blockchain) {undo_all119,3996
    pub fn size(&self) -> usize {size125,4191
impl Eq for UtxoPool {}UtxoPool130,4258
impl PartialEq for UtxoPool {UtxoPool132,4283
    fn eq(&self, other: &Self) -> bool {eq133,4313
impl fmt::Display for UtxoPool {UtxoPool140,4596
    fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt141,4629

utxo/mod.rs,729
pub struct Utxo {Utxo10,164
impl Utxo {Utxo15,221
    pub fn new(id: UtxoId, data: UtxoData) -> Self {new16,233
    pub fn id(&self) -> &UtxoId {id20,319
    pub fn data(&self) -> &UtxoData {data24,377
    pub fn txid(&self) -> Hash {txid29,491
    pub fn vout(&self) -> usize {vout33,554
    pub fn amount(&self) -> u32 {amount37,618
    pub fn public_key(&self) -> &PublicKey {public_key41,686
impl Eq for Utxo {}Utxo46,772
impl PartialEq for Utxo {Utxo48,793
    fn eq(&self, other: &Self) -> bool {eq49,819
// impl fmt::Display for Utxo {Utxo54,897
//     fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {fmt55,929
pub mod data;data67,1281
pub mod id;id68,1295
pub mod pool;pool69,1307
